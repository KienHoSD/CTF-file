from Crypto.Util.number import *
from sage.all import *

# Read in the values of p, e, and h from the output.txt file
with open('output.txt', 'r') as f:
    p = int(f.readline()[2:])
    e = vector(eval(f.readline()[2:]))
    h = vector(eval(f.readline()[2:]))

# Determine the dimension of the matrix x
n = len(h)

# Construct the matrix M whose rows are the vectors (x[i], h[i])
M = matrix([list(x[i]) + [h[i]] for i in range(n)])

# Use the LLL algorithm to find a short vector in the lattice generated by the rows of M
B = M.LLL()

# Extract the secret message (flag) from the last coordinate of the short vector
s = B[-1][-1]

# Convert the long integer s back to bytes to retrieve the flag
flag = long_to_bytes(s)

# Print the flag
print(flag)