
<!DOCTYPE html>
<html lang="en">
<head>
<title>ASN.1 vs DER vs PEM vs x509 vs PKCS#7 vs ....</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="I was really confused about all those acronyms when I started digging into OpenSSL and RFCs. So here&#039;s a no bullshit quick intro to them.
PKCS#7
Or Public-Key Crypto Standard number 7. It&#039;s just a guideline, set of rules, on how to send messages, sign messages, etc... There are a bunch of PKCS that tells you exactly how to do stuff using crypto. PKCS#7 is the one who tells you how to sign and encr ...">
<meta name="author" content="david wong">
<meta charset="UTF-8">

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.2/js/collapse.js"></script>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/webfont/1.6.28/webfontloader.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.5.1/snap.svg-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/underscore@1.13.1/underscore-umd-min.js"></script>
<script src="/public/js/sequence-diagram-min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/go.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/monokai-sublime.min.css">


<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet" type="text/css">


<script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      jax: ["input/TeX","input/MathML","input/AsciiMath","output/CommonHTML"],
      extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },

      asciimath2jax: {
      ignoreClass: "comment"
      },
      tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      ignoreClass: "comment"
      }
      });
    </script>
<script data-cfasync="false" type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js">
    </script>

<link rel="alternate" type="application/rss+xml" title="RSS | David Wong | cryptologie.net" href="/feed/index/html">

<link rel="stylesheet" type="text/css" href="/public/css/style.css">
</head>
<body>
<header>
<div class="flexflex">
<img src="/public/img/me.png" alt="david wong" class="img-circle">
<p><i class="fa fa-comment"></i> Hey! I'm <strong>David</strong>, the author of the <a href="https://www.manning.com/books/real-world-cryptography?a_aid=Realworldcrypto&a_bid=ad500e09">Real-World Cryptography book</a>. I was previously a crypto architect at <a href="http://o1labs.org/">O(1) Labs</a> (working on the <a href="https://minaprotocol.com/">Mina cryptocurrency</a>), before that I was the security lead for <a href="https://www.diem.com">Diem</a> (formerly Libra) at <a href="https://facebook.com/" target="_blank">Novi (Facebook)</a>, and a security consultant for the Cryptography Services of <a href="https://www.nccgroup.com">NCC Group</a>. This is my blog about <strong>cryptography</strong> and <strong>security</strong> and other related topics that I find interesting.</p>
</div>
</header>
<nav class="navbar navbar-default" role="navigation">
<div class="container">

<div class="navbar-header">
<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
</div>

<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
<ul class="nav navbar-nav">
<li class="active"><a href="/">Blog</a></li>
<li><a href="/links">Links</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLBJMt6zV1c7FN3IjBDr9lydgqGzh_SqHV" target="_blank">Videos</a></li>
<li><a href="https://anchor.fm/david-wong8/episodes/Cryptocurrencies-from-scratch-databases--the-banking-world--and-distributed-systems-e1n6925" target="_blank">Podcast</a></li>
<li><a href="/graphics">Graphics</a></li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://twitter.com/cryptodavidw" target="_blank"><i class="fab fa-twitter"></i></a></li>
<li><a href="https://github.com/mimoo" target="_blank"><i class="fab fa-github"></i></a></li>
<li><a href="/contact/"><i class="fas fa-envelope"></i></a></li>
</ul>
</div>
</div>
</nav>
<div class="container">
<div class="grid">
<main>
<article class="mathjax">
<h1>ASN.1 vs DER vs PEM vs x509 vs PKCS#7 vs .... <small class="date" title="2015-04-13 17:00:22"><i class="far fa-clock"></i> posted April 2015</small></h1>
<p>I was really confused about all those acronyms when I started digging into OpenSSL and RFCs. So here's a no bullshit quick intro to them.</p>
<h1>PKCS#7</h1>
<p>Or <strong>Public-Key Crypto Standard number 7</strong>. It's just a guideline, set of rules, on how to send messages, sign messages, etc... There are a bunch of <a href="https://en.wikipedia.org/wiki/PKCS">PKCS</a> that tells you exactly how to do stuff using crypto. PKCS#7 is the one who tells you how to sign and encrypt messages using certificates.
If you ever see "pkcs#7 padding", it just refers to the padding explained in pkcs#7.</p>
<h1>X509</h1>
<p>In a lot of things in the world (I'm being very vague), we use <strong>certificates</strong>. For example each person can have a certificate, and each person's certificate can be signed by the government certificate. So if you want to verify that this person is really the person he pretends to be, you can check his certificate and check if the government signature on his certificate is valid.</p>
<p>TLS use x509 certificates to authenticate servers. If you go on http<strong>s</strong>://www.facebook.com, you will first check their certificate, see who signed it, checked the signer's certificate, and on and on until you end up with a certificate you can trust. And then! And only then, you will encrypt your session.</p>
<p>So x509 certificates are just objects with the name of the server, the name of who signed his certificate, the signature, etc...</p>
<p>Example from <a href="https://en.wikipedia.org/wiki/X.509">wikipedia</a>:</p>
<pre><code>    Certificate
        Version
        Serial Number
        Algorithm ID
        Issuer
        Validity
            Not Before
            Not After
        Subject
        Subject Public Key Info
            Public Key Algorithm
            Subject Public Key
        Issuer Unique Identifier (optional)
        Subject Unique Identifier (optional)
        Extensions (optional)
            ...
    Certificate Signature Algorithm
    Certificate Signature</code></pre>
<h1>ASN.1</h1>
<p>So, how should we write our certificate in a computer format? There are a billion ways of formating a document and if we don't agree on one then we will never be able to ask a computer to parse a x509 certificate.</p>
<p>That's what ASN.1 is for, it tells you exactly how you should write your object/certificate</p>
<h1>DER</h1>
<blockquote>
<p>ASN.1 defines the abstract syntax of information but does not restrict the way the information is encoded. Various ASN.1 encoding rules provide the transfer syntax (a concrete representation) of the data values whose abstract syntax is described in ASN.1.</p>
</blockquote>
<p>Now to encode our ASN.1 object we can use a bunch of different encodings specified in ASN.1, the most common one being used in TLS is DER</p>
<p>DER is a TLV kind of encoding, meaning you first write the Tag (for example, "serial number"), and then the Length of the following value, and then the Value (in our example, the serial number).</p>
<p>DER is also more than that:</p>
<blockquote>
<p>DER is intended for situations when a unique encoding is needed, such as in cryptography, and ensures that a data structure that needs to be digitally signed produces a unique serialized representation.</p>
</blockquote>
<p>So there is only one way to write a DER document, you can't re-order the elements.</p>
<p>And a made up example for an ASN.1 object:</p>
<pre><code>OPERATION ::= CLASS
{
&amp;operationCode INTEGER UNIQUE,

&amp;InvocationParsType,

&amp;ResponseParsAndResultType,

&amp;ExceptionList ERROR OPTIONAL
}</code></pre>
<p>And its DER encoding:</p>
<pre><code>0110 0111 0010 110...</code></pre>
<h1>Base64</h1>
<p>Base64 is just a way of writing binary data in a string, so you can pass it to someone on facebook messenger for exemple</p>
<p>From the <a href="https://wiki.openssl.org/index.php/Base64">openssl Wiki</a>:</p>
<pre><code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ 
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
0000000000111111111122222222223333333333444444444455555555556666
0123456789012345678901234567890123456789012345678901234567890123</code></pre>
<p>And if you see any equal sign =, it's for padding.</p>
<p>So if the first 6 bits of your file is '01' in base 10, then you will write that as B in plaintext. See <a href="https://en.wikipedia.org/wiki/Base64#Examples">an example</a> if you still have no idea about what I'm talking about.</p>
<h1>PEM</h1>
<p>A pem file is just two comments (that are very important) and the data in base64 in the middle. For example the pem file of an encrypted private key:</p>
<pre><code>-----BEGIN ENCRYPTED PRIVATE KEY-----
MIIFDjBABgkqhkiG9w0BBQ0wMzAbBgkqhkiG9w0BBQwwDgQIS2qgprFqPxECAggA
MBQGCCqGSIb3DQMHBAgD1kGN4ZslJgSCBMi1xk9jhlPxP3FyaMIUq8QmckXCs3Sa
9g73NQbtqZwI+9X5OhpSg/2ALxlCCjbqvzgSu8gfFZ4yo+Xd8VucZDmDSpzZGDod
X0R+meOaudPTBxoSgCCM51poFgaqt4l6VlTN4FRpj+c/WZeoMM/BVXO+nayuIMyH
blK948UAda/bWVmZjXfY4Tztah0CuqlAldOQBzu8TwE7WDwo5S7lo5u0EXEoqCCq
H0ga/iLNvWYexG7FHLRiq5hTj0g9mUPEbeTXuPtOkTEb/0ckVE2iZH9l7g5edmUZ
GEs=
-----END ENCRYPTED PRIVATE KEY-----</code></pre>
<p>And yes the number of - are important</p>
</article>
<div class="end_post">Well done! You've reached the end of my post. Now you can <a href="">leave a comment</a> or read something else.</div>
<div id="links" style="display:grid; grid-template-columns: 1fr 1fr; font-size:13px;grid-column-gap: 20px;">
<div class="popular">
<p>Here are some random <strong>popular</strong> articles:</p>
<ul class="fa-ul">
<li>- <a href="/article/193/schnorrs-signature-and-non-interactive-protocols/">Schnorr&#039;s Signature and non-interactive Protocols</a></li>
<li>- <a href="/article/374/common-x509-certificate-validationcreation-pitfalls/">Common x509 certificate validation/creation pitfalls</a></li>
<li>- <a href="/article/306/hash-based-signatures-part-i-one-time-signatures-ots/">Hash-Based Signatures Part I: One-Time Signatures (OTS)</a></li>
<li>- <a href="/article/371/fault-attacks-on-rsas-signatures/">Fault attacks on RSA&#039;s signatures</a></li>
<li>- <a href="/article/419/zeroing-memory-compiler-optimizations-and-memset_s/">Zero&#039;ing memory, compiler optimizations and memset_s</a></li>
<li>- <a href="/article/417/how-did-length-extension-attacks-made-it-into-sha-2/">How did length extension attacks made it into SHA-2?</a></li>
<li>- <a href="/article/471/database-encryption/">Database Encryption</a></li>
</ul>
</div>
<div class="links2">
<p>Here are some random <strong>recent</strong> articles:</p>
<ul class="fa-ul">
<li>- <a href="/article/563/panel-how-zkps-and-other-advanced-cryptographic-schemes-can-be-deployed-to-solve-hard-problems-in-decentralized-systems/">Panel: how ZKPs and other advanced cryptographic schemes can be deployed to solve hard problems in decentralized systems</a></li>
<li>- <a href="/article/591/pailliers-additively-homomorphic-cryptosystem/">Paillier&#039;s additively homomorphic cryptosystem</a></li>
<li>- <a href="/article/565/cff22-trip-report/">CFF22 trip report</a></li>
<li>- <a href="/article/581/state-monads-in-ocaml/">State monads in OCaml</a></li>
<li>- <a href="/article/589/zkvms-are-cool-but-have-you-heard-of-zkcpus/">zkVMs are cool, but have you heard of zkCPUs?</a></li>
<li>- <a href="/article/577/the-intuition-behind-the-sum-check-protocol-in-5-minutes/">The intuition behind the sum-check protocol in 5 minutes</a></li>
<li>- <a href="/article/558/are-system-thinkers-right-and-why-i-left-security/">Are system thinkers right? And why I left security</a></li>
</ul>
</div>
</div>
<div id="comments">
<h2>Comments</h2>
<div class="comment">
<h4>
Dicky
</h4>
<p>Thanks for such of brilliant explanation of all those acronym. It helps me as newbie to understand what all it about. Btw I have a question. How do I create a certificate file if I have ASN1 DER data? I would like to create pfx file at the end.</p>
</div>
<div class="comment">
<h4>
david
</h4>
<p>I think you can do something like `openssl asn1parse -in yourfile -inform der -out newfile -outform pem` to transform your der file into something else. I don&#039;t know for pfx, you might have some special too that could do that.</p>
</div>
<div class="comment">
<h4>
cris
</h4>
<p>I would say that PKCS does not stand for Public-Key CryptoSystem but Public Key Cryptography Standards... </p>
</div>
<div class="comment">
<h4>
david
</h4>
<p>yes! I fixed it, thanks Cris :)</p>
</div>
<div class="comment">
<h4>
<a href="no" rel="nofollow" target="_blank">cris</a>
</h4>
<p>thanks David!! i appreciate it, you hot boy! :)</p>
</div>
<div class="comment">
<h4>
<a href="&gt;&lt;/a&gt;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;poop&quot;);&lt;/script&gt;" rel="nofollow" target="_blank">cris</a>
</h4>
<p>I would say that PKCS does not stand for Public-Key CryptoSystem but Public Key Cryptography Standards...</p>
</div>
<div class="comment">
<h4>
<a href="&quot;&gt;&lt;/a&gt;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;poop&quot;);&lt;/script&gt;&lt;a href=&quot;" rel="nofollow" target="_blank">cris</a>
</h4>
<p>I would say that PKCS does not stand for Public-Key CryptoSystem but Public Key Cryptography Standards...</p>
</div>
<div class="comment">
<h4>
david
</h4>
<p>try hard</p>
</div>
<div class="comment">
<h4>
George
</h4>
<p>Great post David! Just to add to the definition of PKCS#7: it&#039;s also widely used as a container for multiple related certs, say in a certificate signing chain, where your end entity cert (the one you were issued) is packaged with all the intermediate and root CA (Certificate Authority, DigiCert/Verisign, etc.) certs that signed/authenticated your cert.</p>
</div>
<div class="comment">
<h4>
George
</h4>
<p>Great post David! Just to add to the definition of PKCS#7: it&#039;s also widely used as a container for multiple related certs, say in a certificate signing chain, where your end entity cert (the one you were issued) is packaged with all the intermediate and root CA (Certificate Authority, DigiCert/Verisign, etc.) certs that signed/authenticated your cert.</p>
</div>
<div class="comment">
<h4>
Marco
</h4>
<p>Thank you<br />
Very usefull</p>
</div>
<div class="comment">
<h4>
Stan
</h4>
<p>Super useful post for me who just started diving into all this. Right now im signing using openssl on linux but the signature is verified in java and i keep losing 1-8 bytes randomly in a java signature length error e.g. like 253 instead of 256. Ever seen anything like that?</p>
</div>
<div class="comment">
<h4>
<a href="exploitdb.com" rel="nofollow" target="_blank">Bobby Tables</a>
</h4>
<p>Great stuff, thank you ser</p>
</div>
<h2>leave a comment...</h2>
<div class="commentaires">
<form method="post">
<fieldset>
<div class="form-group">
<label for="name">Your name</label>
<input type="text" class="form-control" id="name" placeholder="Enter name" name="name" required>
</div>
<div class="form-group">
<label for="name">Do you have a homepage?</label>
<input type="text" class="form-control" id="web" placeholder="This information will be displayed" name="web">
</div>
<div class="form-group">
<label for="capital">Capital of Italy? (antispam)</label>
<input type="text" class="form-control" id="capital" placeholder="Enter antispam" name="capital" required>
</div>
<div class="form-group">
<label for="text">Text</label>
<textarea class="form-control" rows="7" name="text" placeholder="Enter text" required></textarea>
</div>
<button type="submit" class="btn btn-default">Post</button>
</fieldset>
</form>
</div>
<form method="post"></form>
</div>
</main>
<section id="links">
<div class="book_promo">
<img src="https://realworldcryptography.com/images/building4.png" width="300px">
<p>My book <strong>Real-World Cryptography</strong> is finished and shipping! <a href="https://www.manning.com/books/real-world-cryptography?a_aid=Realworldcrypto&a_bid=ad500e09" style="color:#a54e1a">You can purchase it here</a>.</p>
</div>
<div class="popular">
<p>If you don't know <strong>where to start</strong>, you might want to check these popular articles:</p>
<ul class="fa-ul">
<li>- <a href="/article/193/schnorrs-signature-and-non-interactive-protocols/">Schnorr&#039;s Signature and non-interactive Protocols</a></li>
<li>- <a href="/article/374/common-x509-certificate-validationcreation-pitfalls/">Common x509 certificate validation/creation pitfalls</a></li>
<li>- <a href="/article/306/hash-based-signatures-part-i-one-time-signatures-ots/">Hash-Based Signatures Part I: One-Time Signatures (OTS)</a></li>
<li>- <a href="/article/371/fault-attacks-on-rsas-signatures/">Fault attacks on RSA&#039;s signatures</a></li>
<li>- <a href="/article/419/zeroing-memory-compiler-optimizations-and-memset_s/">Zero&#039;ing memory, compiler optimizations and memset_s</a></li>
<li>- <a href="/article/417/how-did-length-extension-attacks-made-it-into-sha-2/">How did length extension attacks made it into SHA-2?</a></li>
<li>- <a href="/article/471/database-encryption/">Database Encryption</a></li>
</ul>
</div>
<div class="links2">
<p>Here are the latest <strong><a href="/links">links</a></strong> posted:</p>
<ul class="fa-ul">
<li>24 Mar <a href="/links/link/2930#disqus_thread">Quadratic Sieve</a></li>
<li>23 Mar <a href="/links/link/2929#disqus_thread">R1Cs And Qap (Zksnarks) : From Zero To Hero With Finite Fields &amp; Sagemath</a></li>
<li>11 Feb <a href="/links/link/2928#disqus_thread">The Joy Of Duplexes</a></li>
<li>10 Feb <a href="/links/link/2927#disqus_thread">Nist Selects ‘Lightweight Cryptography’ Algorithms To Protect Small Devices</a></li>
<li>05 Feb <a href="/links/link/2926#disqus_thread">The Kzg/kate Polynomial Commitment Scheme</a></li>
</ul>
<p style="margin:10px 0 0;">You can also <strong><a href="/links#post">suggest a link</a></strong>.</p>
</div>
<div class="mailinglist style=" border:2px solid black;"">

<link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	      #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
	      /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	      We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
	    </style>
<div id="mc_embed_signup">
<form action="https://davidwong.us18.list-manage.com/subscribe/post?u=8c101c590815d311e3783824c&amp;id=7347c1b15a" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
<div id="mc_embed_signup_scroll">
<h2>Subscribe to the mailing list</h2>
<div class="mc-field-group">
<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="your email">
</div>
<div id="mce-responses" class="clear">
<div class="response" id="mce-error-response" style="display:none"></div>
<div class="response" id="mce-success-response" style="display:none"></div>
</div> 
<div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_8c101c590815d311e3783824c_7347c1b15a" tabindex="-1" value=""></div>
<div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
</div>
</form>
</div>
<script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';fnames[5]='BIRTHDAY';ftypes[5]='birthday';}(jQuery));var $mcj = jQuery.noConflict(true);</script>

</div>
</section>
</div>
</div>
<footer>
<div class="container">
<small>Thanks for reading! Need to tell me something? <a href="/contact">Contact me</a></small>
</div>
</footer>
<script>
      var options = {theme: 'simple'};
      $(".sequence").sequenceDiagram(options);

      // to re-size the SVG, yolo
      /*
      $('svg').removeAttr('viewBox');

      $('svg').each(function () { 
      let svg = $(this)[0];
      let bbox = svg.getBBox();
      svg.setAttribute("viewBox", bbox.x + ' ' + bbox.y + ' ' + bbox.width + ' ' + bbox.height);
      });

      $('svg').css('width', '500px');
      $('svg').css('height', 'auto');
      */
    </script>
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-190811-18', 'auto');
      ga('send', 'pageview');

    </script>
</body>
</html>
